# Data Model: Mermaid ERD Diagram Documentation

## Core Entities

### ERD Generator
**Purpose**: Main entity responsible for generating Mermaid ERD diagrams from SQLModel definitions

**Attributes**:
- `models_path`: Path to SQLModel definitions (default: `backend/app/models.py`)
- `output_path`: Path for generated ERD documentation (default: `docs/database/erd.md`)
- `mermaid_syntax`: Mermaid ERD syntax configuration
- `validation_rules`: Rules for ERD validation and error checking

**Relationships**:
- Generates: ERD Output
- Validates: Model Metadata
- Processes: Database Models

### Model Metadata
**Purpose**: Extracted metadata from SQLModel classes for ERD generation

**Attributes**:
- `class_name`: Name of the SQLModel class
- `table_name`: Database table name (inferred from class)
- `fields`: List of field metadata objects
- `relationships`: List of relationship metadata objects
- `constraints`: List of constraint metadata objects
- `primary_key`: Primary key field information

**Relationships**:
- Extracted from: Database Models
- Used by: ERD Generator

### ERD Output
**Purpose**: Generated Mermaid ERD diagram structure

**Attributes**:
- `mermaid_code`: Raw Mermaid syntax string
- `entities`: List of entity definitions
- `relationships`: List of relationship definitions
- `metadata`: Generation metadata (timestamp, version, etc.)
- `validation_status`: Status of ERD validation

**Relationships**:
- Generated by: ERD Generator
- Contains: Entity Definitions, Relationship Definitions

### Entity Definition
**Purpose**: Individual entity (table) definition in ERD

**Attributes**:
- `name`: Entity/table name
- `fields`: List of field definitions
- `primary_key`: Primary key field
- `constraints`: List of constraints (unique, not null, etc.)

**Relationships**:
- Part of: ERD Output
- Has: Field Definitions

### Field Definition
**Purpose**: Individual field definition within an entity

**Attributes**:
- `name`: Field name
- `type`: Field data type
- `nullable`: Whether field allows null values
- `unique`: Whether field has unique constraint
- `default`: Default value if any
- `foreign_key`: Foreign key constraint if any

**Relationships**:
- Belongs to: Entity Definition

### Relationship Definition
**Purpose**: Relationship between entities in ERD

**Attributes**:
- `from_entity`: Source entity name
- `to_entity`: Target entity name
- `cardinality`: Relationship cardinality (1:1, 1:N, N:M)
- `foreign_key_field`: Field that implements the relationship
- `constraint_type`: Type of constraint (CASCADE, SET NULL, etc.)

**Relationships**:
- Part of: ERD Output
- Connects: Entity Definitions

## State Transitions

### ERD Generation Workflow
1. **Initialization**: ERD Generator loads configuration
2. **Model Discovery**: Scan for SQLModel classes in specified path
3. **Metadata Extraction**: Parse SQLModel definitions to extract metadata
4. **Validation**: Validate model metadata for ERD generation
5. **Diagram Generation**: Create Mermaid ERD syntax from metadata
6. **Output Creation**: Generate ERD Output with Mermaid code
7. **Documentation Update**: Write ERD to documentation file

### Error States
- **Parse Error**: Invalid SQLModel syntax detected
- **Validation Error**: Model metadata fails validation rules
- **Generation Error**: ERD generation fails due to model issues
- **Output Error**: File writing or documentation update fails

## Validation Rules

### Model Metadata Validation
- All SQLModel classes must have `table=True` for ERD inclusion
- Primary keys must be properly defined
- Foreign key relationships must reference valid entities
- Field types must be supported by Mermaid ERD syntax

### ERD Output Validation
- Generated Mermaid syntax must be valid
- All entities must have at least one field
- Relationships must reference existing entities
- Diagram must be renderable by Mermaid

### Documentation Integration Validation
- Output file must be writable
- Generated content must follow project documentation standards
- ERD must be properly formatted for Markdown rendering
